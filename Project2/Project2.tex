%! Author = utoking
%! Date = 2021/12/17

% Preamble
\documentclass[11pt]{ctexart}

% Packages
\usepackage{amsmath}
\usepackage{geometry}
\usepackage{indentfirst}
\usepackage{minibox}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage[export]{adjustbox}
\usepackage{float}
\usepackage{wrapfig}
\usepackage{amssymb}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[framed,numbered,autolinebreaks,useliterate]{mcode}
\usepackage{amsthm}
\usepackage{hyperref}

\title{数学实验 Project 2}

% Document
\begin{document}
	\maketitle
	\section{问题 1}
	\input{问题-1}

	\section{问题 2}
	因为每一年可用的投资数都可以根据前一年的本利来投资，因此，可以列出每一年的\textbf{可用投资数}，\textbf{实际投资数}，以及\textbf{剩余资本数}。
	这三个量满足 \(\textbf{可用投资数}-\textbf{实际投资数}=\textbf{剩余资本}\), 且第一年的可用投资数为 100w.

	我们需要优化的目标函数就是第五年年末的本利，优化的参数则是每个项目每年的实际投资数。
	因为共计投资 11 次，因此是一个 \(11\times 1\) 的向量。
	其中 \(x_1 \sim x_4\) 为项目一在 1 到 4 年的投资数。
	\(x_5,x_6\) 分别代表项目 2 和项目 3 在第 3 年和第 2 年的投资数。
	\(x_7\sim x_{11}\) 代表项目 5 在第 1 到 5 年的投资数。
	需要的约束条件有下界，即全部都大于等于 0.
	约束条件中的上界除了 \(x_5,x_6\) 设为 40 和 30，其余设为 100 即可。
	最后在每次投资时不得超出可用的投资数，即每次的剩余资本都要大于等于 0.
	这个可以另写一个函数用作非线性约束。

	优化的目标函数在 exp2func1.m 中，非线性优化约束在 exp2func2.m 中。
	主程序在 exp2.m 中。

	以下是优化的结果
	\begin{figure}[H]
		\centering
		\includegraphics[]{picture/exp2}
	\end{figure}

	因此第五年年末能收获的最大本利为 143.75w.

	\clearpage

	\section{问题 3}
	依照题目所给的迭代式计算，相关代码在 exp3.m 中，以下分别是 \(g_0\) 取 0.05, 0.5, 1, 1.5 的时候的图像，\(r\) 取值在 0 到 100 之间的图像。
	\begin{figure}[H]
		\centering
		\begin{subfigure}[h]{0.4\textwidth}
			\includegraphics[width=\textwidth]{picture/exp3_1_1}
			\caption{\(g_0=0.05\)}
		\end{subfigure}
		\begin{subfigure}[h]{0.4\textwidth}
			\includegraphics[width=\textwidth]{picture/exp3_1_2}
			\caption{\(g_0=0.5\)}
		\end{subfigure}

		\begin{subfigure}[h]{0.4\textwidth}
			\includegraphics[width=\textwidth]{picture/exp3_1_3}
			\caption{\(g_0=1\)}
		\end{subfigure}
		\begin{subfigure}[h]{0.4\textwidth}
			\includegraphics[width=\textwidth]{picture/exp3_1_4}
			\caption{\(g_0=1.5\)}
		\end{subfigure}
		\label{fig:}
	\end{figure}

	应用这个方法的有点有如下几点：
	\begin{itemize}
		\item 这种方法可以避免初始值奇异的情况，注意到在原表达式中存在 \(f/r\) 的项，则在做第一次迭代时会出现正无穷，而用
		\(r_{n+\frac{1}{2}}\) 则可以避免这种情况。
		\item 注意到 \(\frac{1}{r^2}\frac{\text{d}(r^2 f)}{\text{d}r}=
		\frac{\text{d}f}{\text{d}r}+\frac{2f}{r}\), 这种方法可以使得计算 \(f\) 时具有更高的精度。
	\end{itemize}

\end{document}